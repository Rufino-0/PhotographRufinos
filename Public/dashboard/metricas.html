<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Photograph | Metricas</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<<<<<<< HEAD
<body onload="exibirGraficos()">
=======
<body onload="mostrarGraficos()">
>>>>>>> 8371e951fd1c1757890263f38cd3a8079bee3a8b
    <nav id="navbar">
        <a onclick="limparSessaohome()" href="../dashboard/dashSite.html"><img id="logo"
                src="../assets/index/LogoBlack.png" alt="LogoBlack"></a>
        <ul>
            <li class="dropdown"><a>Fotografia</a>

                <div class="dropdown-menu">
                    <a href="../paginas/Objetos.html">Objetos</a>
                    <a href="../paginas/Pessoaa.html">Pessoas</a>
                    <a href="../paginas/paisagem.html">Paisagens</a>
                </div>
            </li>

            <li class="dropdown2"> <a>Games</a>

                <div class="dropdown-menu2">
                    <a href="../dashboard/Game.html">Quiz iniciante</a>
                    <a href="../dashboard/GameExperiente.html">Quiz experiente</a>

                </div>

            </li>

            <li class="dropdown3"> <a>Info</a>

                <div class="dropdown-menu3">
                    <a href="../dashboard/metricas.html">Metricas</a>
                </div>
            </li>
        </ul>
        <button onclick="limparSessao()"><img id="exit" src="../assets/dash/exit.png" alt=""></button>
    </nav>


    <div class="container" id="container">


    </div>
</body>

</html>
<script>

    function exibirGraficos() {

        document.getElementById("container").innerHTML += `
                <div class="grafico">
                    <h3>Score Quiz - Iniciante</h3>
                    <canvas id="myChart-acertosIniciante"></canvas>

                </div>
                <div class="grafico">
                    <h3>Score Quiz - Experiente</h3>
                    <canvas id="myChart-acertosExperiente"></canvas>
                </div>
            `
        obterDadosGraficoIniciante();
        obterDadosGraficoExperiente();

    }

    // Iniciante
    function obterDadosGraficoIniciante() {

        fetch(`/medidas/ultimasIniciante/`, { cache: 'no-store' })
            .then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        resposta.reverse();

                        plotarGraficoIniciante(resposta);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGraficoIniciante(resposta) {
        console.log('iniciando plotagem do gráfico...');

        let labels = [];
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Pontuação',
                data: [],
                fill: false,
                borderColor: '#2d88bc',
                borderWidth: 2,
                backgroundColor: '#5da0c7',
                tension: 0.1
            }]
        };

        console.log('Dados recebidos para plotar no gráfico Usuario:', resposta);

        for (let i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.nome);
            dados.datasets[0].data.push(registro.qndPontos);
        }

        console.log('Labels:', labels);
        console.log('Dados do Dataset:', dados.datasets);

        const config = {
            type: 'bar',
            data: dados,
        };

        let ctx = document.getElementById('myChart-acertosIniciante').getContext('2d');

        let myChartIniciante = new Chart(ctx, config);

    }

    // Experiente
    function obterDadosGraficoExperiente() {

        fetch(`/medidas/ultimasExperiente/`, { cache: 'no-store' })
            .then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        resposta.reverse();

                        plotarGraficoExperiente(resposta);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }

    function plotarGraficoExperiente(resposta) {
        console.log('iniciando plotagem do gráfico...');

        let labels = [];
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Pontuação',
                data: [],
                fill: false,
                borderColor: '#2d88bc',
                borderWidth: 2,
                backgroundColor: '#5da0c7',
                tension: 0.1
            }]
        };

        console.log('Dados recebidos para plotar no gráfico Usuario:', resposta);

        for (let i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.nome);
            dados.datasets[0].data.push(registro.qndPontos);
        }

        console.log('Labels:', labels);
        console.log('Dados do Dataset:', dados.datasets);

        const config = {
            type: 'bar',
            data: dados,
        };

        let ctx = document.getElementById('myChart-acertosExperiente').getContext('2d');

        let myChartExperiente = new Chart(ctx, config);

    }

</script>