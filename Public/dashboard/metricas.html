<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Photograph | Metricas</title>
</head>

<body onload="mostrarGrafico()">
    <nav id="navbar">
        <a onclick="limparSessaohome()" href="../dashboard/dashSite.html"><img id="logo"
                src="../assets/index/LogoBlack.png" alt="LogoBlack"></a>
        <ul>
            <li class="dropdown"><a>Fotografia</a>

                <div class="dropdown-menu">
                    <a href="../paginas/Objetos.html">Objetos</a>
                    <a href="../paginas/Pessoaa.html">Pessoas</a>
                    <a href="../paginas/paisagem.html">Paisagens</a>
                </div>
            </li>

            <li class="dropdown2"> <a>Games</a>

                <div class="dropdown-menu2">
                    <a href="../paginas/games/iniciante.html">Quiz Fotografia</a>

                </div>

            </li>

            <li class="dropdown3"> <a>Info</a>

                <div class="dropdown-menu3">
                    <a href="../dashboard/metricas.html">Metricas</a>
                </div>
            </li>
        </ul>
        <button onclick=" limparSessao()"><img id="exit" src="../assets/dash/exit.png" alt=""></button>
    </nav>


    <div class="container">
        <div class="parte1">
            <div class="grafico">
                <h3>Taxa de acertos Quiz - Iniciante</h3>
                <canvas id="myChart-acertosIniciante"></canvas>

            </div>
            <div class="grafico">
                <h3>Rank de pontos - Iniciante</h3>
                <canvas id="myChart-globalIniciante"></canvas>
            </div>
        </div>

        <div class="parte2">
            <div class="grafico">
                <h3>Taxa de acertos Quiz - experiente</h3>
                <canvas id="myChart-acertosExperiente"></canvas>

            </div>
            <div class="grafico">
                <h3>Rank de pontos - Experiente</h3>
                <canvas id="myChart-globalExperiente"></canvas>
            </div>
        </div>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>

</html>
<script>

    var idUsuario = sessionStorage.ID_USUARIO;


    function mostrarGraficos(idUsuario) {
        var graficoiniciante = document.getElementById('myChart-acertosIniciante');
        var graficoExperiente = document.getElementById('myChart-acertosExperiente');
        var graficoGlogalIniciante = document.getElementById('myChart-globalIniciante');
        var graficoGlogalExperiente = document.getElementById('myChart-globalExperiente');


        graficoIniciante.style.display = 'none';
        graficoExperiente.style.display = 'none';
        graficoGlogalIniciante.style.display = 'none';
        graficoGlogalExperiente.style.display = 'none';

    }

    function obterDadosGraficoIniciante() {
        fetch(`/medidas/UltimasMedidas/`, { cache: 'no-store' })
            .then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        resposta.reverse();
                        plotarGraficoIniciante(resposta);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }
    function plotarGraficoIniciante(resposta) {
        console.log('Começando a plotagem de dados...');

        let labels = [];
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Highscore',
                data: [],
                fill: false,
                borderColor: '#00225e',
                borderWidth: 2,
                backgroundColor: '#1b4385',
                tension: 0.1
            }]
        };

        console.log('Dados recebidos para plotar no gráfico Global:', resposta);

        for (let i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.nome);
            dados.datasets[0].data.push(registro.highscore);
        }

        console.log('Labels:', labels);
        console.log('Dados do Dataset:', dados.datasets);

        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    title: {
                        display: true,
                        text: 'Scoreboard Global',
                        font: {
                            size: 16,
                            weight: 'bold',
                            family: 'math'
                        },
                        color: 'black'
                    },
                    legend: {
                        labels: {
                            font: {
                                size: 14, // Tamanho da fonte das legendas
                                weight: 'bold', // Deixar a fonte das legendas em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black'
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            font: {
                                size: 14, // Tamanho da fonte dos rótulos do eixo X
                                weight: 'bold', // Deixar a fonte dos rótulos do eixo X em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black' // Cor do texto dos rótulos do eixo X
                        }
                    },
                    y: {
                        ticks: {
                            font: {
                                size: 12, // Tamanho da fonte dos rótulos do eixo Y
                                weight: 'bold', // Deixar a fonte dos rótulos do eixo Y em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black' // Cor do texto dos rótulos do eixo Y
                        }
                    }
                }
            }
        };

        let ax = document.getElementById('myChart-acertosIniciante').getContext('2d');


        let myChartGlobal = new Chart(ax, config);
    }

    function obterDadosGraficoExperiente() {
        fetch(`/medidas/ultimasMedidas/`, { cache: 'no-store' })
            .then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        resposta.reverse();
                        plotarGraficoExperiente(resposta);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }
    function plotarGraficoExperiente(resposta) {
        console.log('Começando a plotagem de dados...');

        let labels = [];
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Highscore',
                data: [],
                fill: false,
                borderColor: '#00225e',
                borderWidth: 2,
                backgroundColor: '#1b4385',
                tension: 0.1
            }]
        };

        console.log('Dados recebidos para plotar no gráfico Global:', resposta);

        for (let i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.nome);
            dados.datasets[0].data.push(registro.highscore);
        }

        console.log('Labels:', labels);
        console.log('Dados do Dataset:', dados.datasets);

        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    title: {
                        display: true,
                        text: 'Scoreboard Global',
                        font: {
                            size: 16,
                            weight: 'bold',
                            family: 'math'
                        },
                        color: 'black'
                    },
                    legend: {
                        labels: {
                            font: {
                                size: 14, // Tamanho da fonte das legendas
                                weight: 'bold', // Deixar a fonte das legendas em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black'
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            font: {
                                size: 14, // Tamanho da fonte dos rótulos do eixo X
                                weight: 'bold', // Deixar a fonte dos rótulos do eixo X em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black' // Cor do texto dos rótulos do eixo X
                        }
                    },
                    y: {
                        ticks: {
                            font: {
                                size: 12, // Tamanho da fonte dos rótulos do eixo Y
                                weight: 'bold', // Deixar a fonte dos rótulos do eixo Y em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black' // Cor do texto dos rótulos do eixo Y
                        }
                    }
                }
            }
        };

        let ax = document.getElementById('myChart-acertosExperiente').getContext('2d');


        let myChartGlobal = new Chart(ax, config);
    }

    function obterDadosGraficoGlobalIniciante() {
        fetch(`/medidas/ultimasGlobal/`, { cache: 'no-store' })
            .then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        resposta.reverse();
                        plotarGraficoGlobalIniciante(resposta);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }
    function plotarGraficoGlobalIniciante(resposta) {

        console.log('Começando a plotagem de dados...');

        let labels = [];
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Highscore',
                data: [],
                fill: false,
                borderColor: '#00225e',
                borderWidth: 2,
                backgroundColor: '#1b4385',
                tension: 0.1
            }]
        };

        console.log('Dados recebidos para plotar no gráfico Global:', resposta);

        for (let i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.nome);
            dados.datasets[0].data.push(registro.highscore);
        }

        console.log('Labels:', labels);
        console.log('Dados do Dataset:', dados.datasets);

        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    title: {
                        display: true,
                        text: 'Scoreboard Global',
                        font: {
                            size: 16,
                            weight: 'bold',
                            family: 'math'
                        },
                        color: 'black'
                    },
                    legend: {
                        labels: {
                            font: {
                                size: 14, // Tamanho da fonte das legendas
                                weight: 'bold', // Deixar a fonte das legendas em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black'
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            font: {
                                size: 14, // Tamanho da fonte dos rótulos do eixo X
                                weight: 'bold', // Deixar a fonte dos rótulos do eixo X em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black' // Cor do texto dos rótulos do eixo X
                        }
                    },
                    y: {
                        ticks: {
                            font: {
                                size: 12, // Tamanho da fonte dos rótulos do eixo Y
                                weight: 'bold', // Deixar a fonte dos rótulos do eixo Y em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black' // Cor do texto dos rótulos do eixo Y
                        }
                    }
                }
            }
        };

        let ax = document.getElementById('myChart-globalIniciante').getContext('2d');


        let myChartGlobal = new Chart(ax, config);
    }

    function obterDadosGraficoGlobalExperiente() {
        fetch(`/medidas/ultimasGlobal/`, { cache: 'no-store' })
            .then(function (response) {
                if (response.ok) {
                    response.json().then(function (resposta) {
                        console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                        resposta.reverse();
                        plotarGraficoGlobalExperiente(resposta);
                    });
                } else {
                    console.error('Nenhum dado encontrado ou erro na API');
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
            });
    }
    function plotarGraficoGlobalExperiente(resposta) {
        console.log('Começando a plotagem de dados...');

        let labels = [];
        let dados = {
            labels: labels,
            datasets: [{
                label: 'Highscore',
                data: [],
                fill: false,
                borderColor: '#00225e',
                borderWidth: 2,
                backgroundColor: '#1b4385',
                tension: 0.1
            }]
        };

        console.log('Dados recebidos para plotar no gráfico Global:', resposta);

        for (let i = 0; i < resposta.length; i++) {
            var registro = resposta[i];
            labels.push(registro.nome);
            dados.datasets[0].data.push(registro.highscore);
        }

        console.log('Labels:', labels);
        console.log('Dados do Dataset:', dados.datasets);

        const config = {
            type: 'bar',
            data: dados,
            options: {
                plugins: {
                    title: {
                        display: true,
                        text: 'Scoreboard Global',
                        font: {
                            size: 16,
                            weight: 'bold',
                            family: 'math'
                        },
                        color: 'black'
                    },
                    legend: {
                        labels: {
                            font: {
                                size: 14, // Tamanho da fonte das legendas
                                weight: 'bold', // Deixar a fonte das legendas em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black'
                        }
                    }
                },
                scales: {
                    x: {
                        ticks: {
                            font: {
                                size: 14, // Tamanho da fonte dos rótulos do eixo X
                                weight: 'bold', // Deixar a fonte dos rótulos do eixo X em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black' // Cor do texto dos rótulos do eixo X
                        }
                    },
                    y: {
                        ticks: {
                            font: {
                                size: 12, // Tamanho da fonte dos rótulos do eixo Y
                                weight: 'bold', // Deixar a fonte dos rótulos do eixo Y em negrito
                                family: 'math' // Fonte importada
                            },
                            color: 'black' // Cor do texto dos rótulos do eixo Y
                        }
                    }
                }
            }
        };

        let ax = document.getElementById('myChart-globalExperiente').getContext('2d');


        let myChartGlobal = new Chart(ax, config);
    }
</script>